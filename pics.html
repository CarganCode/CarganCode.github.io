---
layout: pics
title: Pics
description: It takes a while for it to load. To see all pics from a day just click on the date
---

    <style>

      .pic {
        padding: 0;
        margin: 5px;
      }
      .album_cont {
        margin: 10px 0;
      }
      a h3{ color: #282822; cursor: pointer;}
      .album_cont h3{
        margin-top: 0;
      }
      .dlink{
        text-shadow: 0px 2px 5px rgba(0,0,0,0.2);
        left: -40px;
        color: rgba(255, 255, 255, 0.5);
        position: relative;
        display: block;
        width: 0;
        font-size: 30px;
      }
      h1{
        margin: 0;
      }
      .window {
        position: fixed;
        top:0;
        height: 100%;
        width: 100%;
        background: rgba(0,0,0,0.7);
        display: flex;
        justify-content: center;
        align-items: center;
      }
      #window img{
        max-width: 100%;
        margin: 5px;
      }
      #window .dlink{
        position: initial;
        width: initial;
        text-align: right;
        margin: -15px 5px;
      }
      #window .arrow {
        font-size: 50px;
        margin: 0;
      }
    </style>

  <body>
  
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
     <script type="text/javascript">
        var pics ={}
        
        var tImg = '<div class="card pic" style="display: inline-flex;"><img onclick=swindow(\"%%date%%\",%%index%%) src="%%id%%"> <a href="%%mlink%%" download="%%name%%" class="dlink" > <i class="fa fa-cloud-download"></i></a></div>'

        function build(data){
            for (r in data){
              var fileName = data[r].name.split("/").pop()
              var surl = data[r].surl
              d = new Date(parseInt(data[r].ctime) * 1000)
              date = d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate()
              img = {"img_name": fileName, "media_link": "http://cdn.cargancode.io/jpg/" + fileName, "surl": surl}
              pics[date] ? pics[date].push(img) : pics[date] = [img]
            }

            var w = '<div class="window" id="window" onclick=twindow() style="display: none">' +
            '<i id="previous" class="dlink arrow fa fa-angle-left"></i><div><img>' +
            '<br>' +
            '<a href="%%mlink%%" download="%%name%%" class="dlink"><i class="fa fa-cloud-download"></i>Download</a></div>' +
            '<i id="next" class="dlink arrow fa fa-angle-right"></i></div>'
            $(w).appendTo('body')

            for (date in pics){
              var ddiv = "<div class='card album_cont' id='%%date%%'></div>".replace("%%date%%", date)
              $(ddiv).appendTo('.post-content')
              var hd = "<a onclick=more('" + date + "')><h3>" + date + "<span class=big> - " + pics[date].length + " Pics</span></h3></a>"
              $(hd).appendTo('#' + date)

              var max = 5 < pics[date].length ? 5: pics[date].length
              for (var i=0;  i < max ; i++){
                var picnum = Math.floor((pics[date].length / max) * i)
                add(date, picnum)
                
              }
            }
        }
        function more(date) {
          if (!pics[date].expand) {
            var max = 5 < pics[date].length ? 5: pics[date].length
                for (var i=max;  i < pics[date].length ; i++){
                  add(date, i)                
                }
            pics[date].expand = true
          }
        }

        function add(date, index){
          var img_url = pics[date][index].surl
          var img_name = pics[date][index].img_name
          var media_link = pics[date][index].media_link
          var nImg = tImg.replace(/%%id%%/g, img_url).replace("%%mlink%%", media_link).replace(/%%name%%/g, img_name).replace(/%%date%%/g, date).replace(/%%index%%/g, index)
          $(nImg).appendTo('#' + date)
        }

        function twindow(){
          console.log(event)
          console.log("t")
          enableScroll()
          $("#window").toggle()
        }

        function swindow(date, index, isNext) {
          console.log("s")
          event.stopPropagation()
          event.stopImmediatePropagation()

          var img_url = pics[date][index].surl
          var media_link = pics[date][index].media_link
          var img_name = pics[date][index].img_name

          var max_height = window.innerHeight - 100;

          img_url += "=s1200"
          var img = $('<img>')

          next = pics[date].length != (index + 1)? (index + 1): 0;
          previous = 0 <= (index - 1)? (index - 1): pics[date].length - 1;
          ocn= 'swindow(\"%%date%%\",%%index%%, true)'.replace(/%%date%%/g, date).replace(/%%index%%/g, next)
          ocp= 'swindow(\"%%date%%\",%%index%%, true)'.replace(/%%date%%/g, date).replace(/%%index%%/g, previous)

          img.attr('onclick', ocn)
          img.attr('src', img_url);
          img.css({'max-height': max_height + 'px'})

          $('#window a').attr('href', media_link).attr('download', img_name).attr('onclick', "event.stopPropagation()")
          $("#window img").replaceWith(img)

          $("#next").attr('onclick', ocn)
          $("#previous").attr('onclick', ocp)

          if(!isNext){
            disableScroll()
            $("#window").toggle()
          }else{
            
          }
          
        }


        // left: 37, up: 38, right: 39, down: 40,
        // spacebar: 32, pageup: 33, pagedown: 34, end: 35, home: 36
        var keys = {37: 1, 38: 1, 39: 1, 40: 1};

        function preventDefault(e) {
          e = e || window.event;
          if (e.preventDefault)
              e.preventDefault();
          e.returnValue = false;  
        }

        function preventDefaultForScrollKeys(e) {
            if (keys[e.keyCode]) {
                preventDefault(e);
                return false;
            }
        }

        function disableScroll() {
          if (window.addEventListener) // older FF
              window.addEventListener('DOMMouseScroll', preventDefault, false);
          window.onwheel = preventDefault; // modern standard
          window.onmousewheel = document.onmousewheel = preventDefault; // older browsers, IE
          window.ontouchmove  = preventDefault; // mobile
          document.onkeydown  = preventDefaultForScrollKeys;
        }

        function enableScroll() {
            if (window.removeEventListener)
                window.removeEventListener('DOMMouseScroll', preventDefault, false);
            window.onmousewheel = document.onmousewheel = null; 
            window.onwheel = null; 
            window.ontouchmove = null;  
            document.onkeydown = null;  
        }
                $(window)
                  .bind('load', function() {
                    $.ajax({
                      url: "http://cargan-code.appspot.com/new",  
                      }).done(function(data) {
                        build(data) 
                      });
                });
    </script>

  </body>